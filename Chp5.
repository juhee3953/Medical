# **No.11 조건 필터링:** "30대 여성이면서 혈압이 130 이상인 사람 뽑기" (`&`(그리고), `|`(또는) 연산자)
#   조건 필터링 (&, |): 여러 조건을 동시에 만족하거나 하나만 만족하는 데이터를 찾습니다.

# & (And): 둘 다 만족

# | (Or): 하나라도 만족

# **No.12 정렬하기 (`sort_values`):** "혈당 높은 순서대로 줄 세우기"
#   정렬 (sort_values): 데이터를 오름차순이나 내림차순으로 정렬합니다. ascending=False를 쓰면 높은 순서(내림차순)가 됩니다.

# **No.13 특정 열만 뽑기:** 전체 데이터에서 '이름'과 '진단명'만 남기기

# 열 선택: df[['열이름1', '열이름2']] 처럼 대괄호를 두 번 사용하여 특정 컬럼만 추출합니다.
import pandas as pd

# 1. 가상 데이터 생성
data = {
    '이름': ['김철수', '이영희', '박민수', '최지우', '정다정', '강건강', '조심해', '윤튼튼', '송미소', '임진료'],
    '나이': [65, 45, 72, 38, 61, 55, 68, 29, 75, 62],
    '혈당': [150, 110, 160, 95, 145, 130, 135, 105, 155, 142]
}
df = pd.DataFrame(data)

# 2. 필터링: 나이 30세 이상 & 혈당 130 이상
# 3. 정렬: 혈당 높은 순서(ascending=False)
high_risk = df[(df['나이'] >= 30) & (df['혈당'] >= 130)].sort_values(by='혈당', ascending=False)

print(high_risk)


# - **No.14 "고위험군 랭킹 매기기"**
#     - 가상의 환자 데이터 10개를 만들고, **'나이가 60세 이상'**이면서 **'혈당이 140 이상'**인 환자를 뽑은 뒤, **혈당이 높은 순서대로** 정렬해서 출력하세요.


# **No.15 결측치 처리 (`isnull`, `fillna`):** 비어있는 혈압 데이터를 '평균값'으로 채우거나, 데이터가 없는 행을 지우기(`dropna`).
# No.15: 결측치 처리 (isnull, fillna, dropna)
# 데이터에 구멍(NaN)이 뚫려 있을 때 대처하는 방법입니다.

# isnull(): 어디가 비어있는지 확인 (True/False)

# fillna(값): 비어있는 곳을 특정 값(평균, 0 등)으로 채움

# dropna(): 비어있는 데이터가 포함된 행을 아예 삭제

# **No.16 파생변수 만들기:** 키(Height)와 몸무게(Weight) 컬럼을 이용해 **'BMI'** 컬럼을 새로 만들어 표에 붙이기.
#   - **No.17 미션: "BMI 자동 계산기"**
#     - 키(cm)와 몸무게(kg) 데이터가 있는 표를 만들고, 코드로 계산하여 맨 오른쪽 열에 `BMI` 수치를 자동으로 채워 넣으세요. (결측치가 있다면 0으로 채우세요!)
# BMI = {Weight(kg)}/{Height(m)^2} (단, 키는 미터(m) 단위로 환산해야 하므로 cm인 경우 100으로 나눕니다.)
import pandas as pd

# 1. 데이터 생성 (결측치 포함)
data = {
    '이름': ['A', 'B', 'C', 'D'],
    '키(cm)': [170, 160, None, 180],
    '몸무게(kg)': [70, 55, 80, None]
}
df_bmi = pd.DataFrame(data)

# 2. 결측치를 0으로 채우기
df_bmi = df_bmi.fillna(0)

# 3. BMI 파생변수 만들기
# 키를 m단위로 바꾸기 위해 100으로 나눈 뒤 제곱(**2)합니다.
df_bmi['BMI'] = df_bmi['몸무게(kg)'] / (df_bmi['키(cm)'] / 100) ** 2

# 분모가 0이 되어 발생하는 에러(inf) 등을 처리하기 위해 최종 결측치 정리
df_bmi = df_bmi.replace([float('inf'), -float('inf')], 0).fillna(0)

print(df_bmi)
